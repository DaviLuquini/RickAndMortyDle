<div class="flex flex-col items-center justify-center relative">
  <div #dropdownWrapper class="flex flex-col items-center justify-center w-full relative">
    <input type="text" placeholder="Type character name..." class="h-14 w-full rounded-lg border-2 border-slate-700 bg-slate-800 px-6 
             text-lg text-slate-200 placeholder-slate-500 outline-none
             transition-all duration-300 ease-in-out
             focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/50" [value]="searchText()"
      [disabled]="isGameOver()" (click)="showDropdown.set(true)" (focus)="showDropdown.set(true)"
      (input)="searchText.set($any($event.target).value)" />

    @if(showDropdown() && filteredInputCharacters().length > 0 && !isGameOver()) {
    <ul class="absolute top-full z-50 max-h-60 overflow-y-auto rounded-lg bg-slate-700 text-slate-200 shadow-lg w-full">
      @for (character of filteredInputCharacters(); track character.id) {
      <li class="px-4 py-2 hover:bg-cyan-500 cursor-pointer flex items-center" (click)="makeGuess(character)"
        (keypress)="makeGuess(character)">
        <img [src]="character.image" alt="{{ character.name }}" class="w-10 h-10 rounded-lg mr-2" />
        {{ character.name }}
      </li>
      }
    </ul>
    }

    @if(showDropdown() && filteredInputCharacters().length == 0 && searchText().length > 1) {
    <ul
      class="absolute top-full mt-1 z-50 max-h-60 overflow-y-auto rounded-lg bg-slate-700 text-slate-200 shadow-lg w-full">
      <li class="px-4 py-2">No characters found.</li>
    </ul>
    }
  </div>
</div>

<div class="mt-6 space-y-2 overflow-x-auto">
  @for (result of guessHistory(); track result.character.id; let i = $index) {
  <app-guess-result [result]="result" [showHeaders]="i === 0" />
  }
</div>

@if(isGameOver()) {
<div #gameOverElement class="p-6 bg-green-600 rounded-lg text-white text-center">
  <h2 class="text-3xl font-bold mb-2">ðŸŽ‰ Congratulations! ðŸŽ‰</h2>
  <p class="text-xl">You guessed correctly in {{ tries() }} tries!</p>
  <span class="text-xl">Next character in: <span class="text-2xl font-bold">{{ timeLeft }}</span></span>
</div>
}